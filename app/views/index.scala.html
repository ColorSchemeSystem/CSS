@(user: Member, chooser: Chooser, path: String, tags: List[String])

@main("Color Scheme", user){ 
<script>

$(window).load(function(){
	fixFrameSize();
	var navi = $('.fixnav');
		var main  = $('.main');
		var target_top = navi.offset().top - parseInt(navi.css('margin-top'),10);
		var sub_top = main.offset().top - parseInt(main.css('margin-top'),10);
		var sub_scroll = main.offset().top + main.outerHeight(true) - navi.outerHeight(true) - parseInt(navi.css('margin-top'),10);

		if (navi.outerHeight(true) + target_top < main.outerHeight(true) + sub_top) {
		$(window).scroll(function () {
			var ws = $(window).scrollTop();
			$('.scroll').text(ws);
			if (ws > sub_scroll) {
			navi.css({position:'fixed', top: sub_scroll - ws + 'px'});
			} else if(ws > target_top) {
			navi.css({position:'fixed', top: '0px'});
			} else {
			navi.css({position:'relative', top: '0px'});
			}
		});
	}
});

function fixFrameSize() {
	if (window.parent) {
		var body = document.body;
		var height = body.scrollHeight;
		var iframe = window.parent.document.getElementsByTagName("iframe")[0];
		iframe.style.height = height + "px";
		iframe.scrolling = "no";
	}
};

/*function hover(name){
	name = "." + name;
	var content = $('iframe').contents().find(name);
	var element = $("<div></div>", {
  					"class" : "hoverImage"
				});

	var css = {
		color : "red",
		position : "absolute",
		width : content.innerWidth(),
		height : content.innerHeight(),
		background : "red",
		filter : "alpha(opacity = 30)",
		MozOpacity : 0.3,
		opacity : 0.3
	};

	content.css("position", "relative");
	element.css(css);
	element.css("top", 0);
	element.css("left", 0);
	element.css("z-index", 1000);
	content.append(element);
};

function hoverOut(name){
	name = "." + name;
	var content = $('iframe').contents().find(name);
	content.css("position", "");
	$('iframe').contents().find('.hoverImage').remove();
};*/

function sendHTML(){
	var ele = $("<input>", {
					"type" : "hidden",
					"name" : "tempHtml",
					"value" : $('iframe').contents().find('html').html()
				});
	$('#sendForm').append(ele);
};

/*$(function() {
	$('tr').click(function(){
		$('#data').toggle();
	});
});*/

</script>
	<div class="main">
		<div class="inHtml">
			<iframe src="@routes.Assets.at(path)" width="920px" name="template" id="iframe"></iframe>
			<script>
				$('#iframe').load(function(){
					//console.log("実行");
					var elements = new Array();
					elements = $('#iframe').contents().find('*');
					//console.log($('#iframe').contents().find('*'));
					$.each(elements, function(index, item){
						var classname = item.className.split(" ")[0];
						var td = $("<td></td>",{
							text : classname
						});
						console.log(classname);
						classN = classname.outerHTML;
						console.log(classN);
						//console.log(td);
						var td2 = $("<td>COLOR</td>");
						//console.log(td2);
						var tr = $("<tr></tr>",{
							on : {
								mouseover : function(classN){
									console.log(classN);
									var classNa = classN.outerHTML;
									classNa = "." + classNa;
									console.log(classNa);
									var content = $('iframe').contents().find(classNa);
									var element = $("<div></div>", {
  										"class" : "hoverImage"
									});
									console.log("オブジェクト作成");
									var css = {
										color : "red",
										position : "absolute",
										width : content.innerWidth(),
										height : content.innerHeight(),
										background : "red",
										filter : "alpha(opacity = 30)",
										MozOpacity : 0.3,
										opacity : 0.3
									};
									console.log("css設定");
									content.css("position", "relative");
									element.css(css);
									element.css("top", 0);
									element.css("left", 0);
									element.css("z-index", 1000);
									console.log("cssセット")
									content.append(element);
									console.log("要素代入")
								},
								mouseOut : function(classname){
									console.log("マウスアウト");
									classname = "." + classname;
									var content = $('iframe').contents().find(classname);
									content.css("position", "");
									$('iframe').contents().find('.hoverImage').remove();
								}
							}
						});
						//console.log(tr);
						tr.append(td);
						tr.append(td2);
						$('#classTable').append(tr);
					});
				});
			</script>
		</div>
		<form method="post" id="sendForm" name="sendForm" action="/template/download">
			<div class="button">
				<input type="button" value="登録">
				<input type="submit" value="HTMLを書き出す" onClick="sendHTML();">
			</div>
		</form>
	</div>
  <div class="side">
    <div class="fixnav">
		<div class="tempButton">
			<a href="#"><button class="button1">テンプレート表示</button></a>
		</div>
      <div class="classTags">
				<div class="table-responsive">
					<table class="table table-hover">
						<thead>
							<tr>
								<th>className</th>
								<th>color</th>
							</tr>
						</thead>
						<tbody id="classTable">



						@for(data <- tags){
							<tr onClick="display(@data);" bgcolor="#AAA" onmouseover="hover('@data')" onmouseout="hoverOut('@data')">
								<td>@data</td>
								<td>COLOR</td>
							</tr>
							<tr id="@data" style="display: none;">
								<td>background</td>
								<td>
									<input type="text" class="form-control" id="@data-back" value="#A6FF00" data-color-format="hex">
								</td>
							</tr>
							<tr id="@data" style="display: none;">
								<td>border</td>
								<td>
									<input type="text" class="form-control" id="@data-bor" value="#A6FF00" data-color-format="hex">
								</td>
							</tr>
							<tr id="@data" style="display: none;">
								<td>font</td>
								<td>
									<input type="text" class="form-control" id="@data-font" value="#A6FF00" data-color-format="hex">
								</td>
							</tr>
							<script>
							$("input#@data-back").ColorPickerSliders({
								placement: $('#chooser').data('placement'),
								hsvpanel: $('#chooser').data('hsvpanel'),
								sliders: $('#chooser').data('sliders'),
								swatches: $('#chooser').data('swatches'),
								previewformat: 'hex'
							},'.@data',"background");
						</script>
						<script>
							$("input#@data-bor").ColorPickerSliders({
								placement: $('#chooser').data('placement'),
								hsvpanel: $('#chooser').data('hsvpanel'),
								sliders: $('#chooser').data('sliders'),
								swatches: $('#chooser').data('swatches'),
								previewformat: 'hex'
							},'.@data',"border");
						</script>
						<script>
							$("input#@data-font").ColorPickerSliders({
								placement: $('#chooser').data('placement'),
								hsvpanel: $('#chooser').data('hsvpanel'),
								sliders: $('#chooser').data('sliders'),
								swatches: $('#chooser').data('swatches'),
								previewformat: 'hex'
							},'.@data',"font");
						</script>
						}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>

	<div id="chooser" data-placement="'@chooser.placement'" data-hsvpanel="@chooser.hsvpanel" data-sliders="@chooser.slider" data-swatches="@chooser.swatche"></div>
	<script type="text/javascript">
		function display(name) {
			$(name).toggle();
		}
	</script>
}

				